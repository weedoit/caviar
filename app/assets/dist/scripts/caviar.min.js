var App;!function(t){t.foo=1}(App||(App={}));var Caviar;!function(t){function n(t,n){{var e;({}).hasOwnProperty}for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function e(t){return"function"==typeof t}function a(){return o}function i(t,n){var e=document.body,a=e.matches||e.webkitMatchesSelector;return a.call(t,n)}function r(){var t=s();return t.app?t.app.exitApp():t.device?t.device.exitApp():console.log("[Caviar] Application supposed to be ended")}var o,s,c={};o=window.location.href.indexOf("x-wmapp0:")>=0,s=function(){return navigator},t.contentBox=document.querySelector(".caviar-stage-container"),t.merge=n,t.isFunction=e,t.runningOnWP=a,t.matchSelector=i,t.exit=r;var u;!function(t){function n(t){return c[t]||null}function e(t,n){return c[t]=n}t.get=n,t.set=e}(u=t.globals||(t.globals={}))}(Caviar||(Caviar={}));var Caviar;!function(t){var n;n={version:"0.0.1",debug:!0,useDatabase:!1,hasSidebarMenu:!0,navbarHeight:50};var e=function(){function e(){}return e.get=function(t){return n[t]},e.set=function(e,a){"object"==typeof e?n=t.merge(e,n):n[e]=a},e}();t.Config=e}(Caviar||(Caviar={}));var Caviar;!function(t){var n=function(){function t(t){this.controller=null,this.controllerInstanceId=null,this.data=null,this.forResult=!1,this.transition="show",this.caller=null,void 0!==t&&("string"==typeof t?this.parseControllerName(t):"object"==typeof t&&(this.parseIntentElement(t),this.caller=t)),this.data={}}return t.prototype.parseIntentElement=function(t){var n,e,a;n=t.getAttribute("intent-data"),e=t.getAttribute("intent-forResults"),a=t.getAttribute("intent-transition"),this.data=null===n||"["!==n.charAt(0)&&"{"!==n.charAt(0)?{}:JSON.stringify(n),this.transition=null!==a?a:"show",this.forResult=null!==e&&"true"===e?!0:!1,this.parseControllerName(t.getAttribute("intent"))},t.prototype.parseControllerName=function(t){this.controller=t.replace(/^([a-z])|_([a-z])/g,function(t){return t.toUpperCase()}).replace(/(\s|_)/g,"")+"Controller"},t}();t.Intent=n}(Caviar||(Caviar={}));var Caviar;!function(t){var n,e=[];!function(t){function n(t){return e.push(t)}function a(){return e[e.length-1]||null}function i(){return e[e.length-2]||null}function r(t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}function o(){return e.pop()}function s(){return e}function c(){return e.length}function u(){return e=[]}function l(){return e.length>1}t.add=n,t.getCurrent=a,t.getPrev=i,t.remove=r,t.removeLast=o,t.all=s,t.count=c,t.clear=u,t.hasPrev=l}(n=t.IntentHistory||(t.IntentHistory={}))}(Caviar||(Caviar={}));var Caviar;!function(t){var n,e,a,i,r,o,s;n=1,e=2,i=[],s=e,a={show:{transitionIn:function(t,n){return[{e:n,p:{opacity:1},options:{duration:1,easing:"ease"}}]},transitionOut:function(t,n){return[{e:n,p:{opacity:1},options:{duration:1,easing:"ease"}}]}},slideLeft:{transitionIn:function(t,n){return[{e:t,p:{scale:.9,opacity:.6},options:{duration:150,easing:"ease"}},{e:n,p:{translateX:[0,"100%"]},options:{duration:300,easing:"ease"}}]},transitionOut:function(t,n){return[{e:t,p:{translateX:["100%",0]},options:{duration:300,easing:"ease"}},{e:n,p:{scale:1,opacity:1},options:{duration:150,easing:"ease"}}]}},slideUp:{transitionIn:function(t,n){return[{e:t,p:{scale:.9,opacity:.6},options:{duration:150,easing:"ease"}},{e:n,p:{translateY:[0,"100%"]},options:{duration:300,easing:"ease"}}]},transitionOut:function(t,n){return[{e:t,p:{translateY:["100%",0]},options:{duration:300,easing:"ease"}},{e:n,p:{scale:1,opacity:1},options:{duration:150,easing:"ease"}}]}}},r=function(t){i.push(t),1===i.length&&s===e&&o()},o=function(){var t=i.shift();t?(s=n,Velocity.RunSequence(t)):s===n&&(s=e)};var c;!function(t){function n(t,n,e){a[t]={transitionIn:n,transitionOut:e}}function e(t,n,e,i){var s,c,u,l,v;s=$(t),c=$(n),u=a[e].transitionIn(t,n),l=u[u.length-1],v="function"==typeof l.options.complete?l.options.complete:function(){},l.options.complete=function(){s.removeClass("caviar-active").addClass("caviar-backgrounded").addClass("caviar-hidden"),c.removeClass("caviar-next").addClass("caviar-active"),i(),v(),o()},r(u)}function i(t,n,e,i){var s,c,u,l,v,f;s=$(t),c=$(n),u=a[e].transitionOut(s,c),l=u[u.length-1],v=u[0],f="function"==typeof l.options.complete?l.options.complete:function(){},v.options.begin=function(){c.removeClass("caviar-hidden")},l.options.complete=function(){s.removeClass("caviar-active").addClass("caviar-dead"),c.removeClass("caviar-backgrounded").addClass("caviar-active"),i(),f(),o()},r(u)}t.register=n,t.transitionIn=e,t.transitionOut=i}(c=t.UITransitions||(t.UITransitions={}))}(Caviar||(Caviar={}));var Caviar;!function(t){var n=function(){function t(t){this.rawTemplate=null,this.template=null,this.sectionsTemplates=null,this.parseSections=function(){var t,n,e,a,i={};e=this.rawTemplate.replace(/@section\('(.*)'\)/g,'<code class="caviar-section $1">').replace(/@endsection/g,"</code>"),a=document.createElement("div"),a.innerHTML=e,t=a.querySelectorAll("code"),[].map.call(t,function(t){n=t.classList[1],i[n]=Handlebars.compile(t.innerHTML,{noEscape:!0}),t.insertBefore(document.createComment("caviar-section-"+n),t.firstChild),t.appendChild(document.createComment("end-caviar-section-"+n))}),this.rawTemplate=a.innerHTML.replace(/<\/?!?(code)[^>]*>/g,""),this.sectionsTemplates=i},this.rawTemplate=t,this.parseTemplate()}return t.prototype.parseTemplate=function(){this.rawTemplate.indexOf("@section")>=0&&this.parseSections(),this.template=Handlebars.compile(this.rawTemplate,{noEscape:!0})},t}();t.View=n}(Caviar||(Caviar={}));var Caviar;!function(t){var n,e=function(){function t(t,n){this.refNodes=null,this.template=null,this.refNodes=t,this.template=n}return t.prototype.append=function(t){var e=this.refNodes,a=n(t);e.opening.parentNode.insertBefore(a,e.closing)},t.prototype.prepend=function(t){var e=this.refNodes,a=n(t),i=e.opening.nextSibling,r=i!==e.closing?i:e.closing;e.opening.parentNode.insertBefore(a,r)},t.prototype.update=function(t){for(var e=this.refNodes,a=e.opening.parentNode,i=e.opening,r=n("string"==typeof t?t:this.template(t));i.nextSibling!==e.closing;)a.removeChild(i.nextSibling);a.insertBefore(r,e.closing)},t.prototype.render=function(t){return this.template(t)},t}();t.Section=e,n=function(t){var n,e=document.createElement("body"),a=document.createDocumentFragment();for(e.innerHTML=t;n=e.firstChild;)a.appendChild(n);return a}}(Caviar||(Caviar={}));var Caviar;!function(t){var n,e=function(){function e(t,n){this.view=null,this.element=null,this.sections=null,this.view=t,this.element=n,this.sections={},this.attachSections()}return e.prototype.getElement=function(){return this.element},e.prototype.attachSections=function(){this.sections=this.parseSections()},e.prototype.parseSections=function(){var e,a,i,r,o,s,c,u=this.element,l=n(u),v=l.length,f=[],d={},p={};for(s=0;v>s;s+=1)i=l[s],"opening"===i.type&&f.push(i),d[i.data]=i;for(e=f.length,c=0;e>c;c+=1){if(a=f[c],o=a.data.replace("caviar-section-",""),r=d["end-"+a.data],!r)throw new Error('Section "'+o+"\" was'nt closed");p[o]=new t.Section({opening:a.node,closing:r.node},this.view.sectionsTemplates[o])}return p},e.COMMENT_NODE=8,e}();t.StagedView=e,n=function(t){var a,i,r,o=t.childNodes.length,s=[];for(r=0;o>r;r+=1)a=t.childNodes[r],i=a.data,a.nodeType===e.COMMENT_NODE?i.indexOf("caviar-section")>=0&&s.push({type:0===i.indexOf("end")?"closing":"opening",data:a.data,node:a}):a.childNodes.length>0&&(s=s.concat(n(a)));return s}}(Caviar||(Caviar={}));var Caviar;!function(t){var n;!function(n){function e(n,e){var a,i;return i=(o+=1)+"_ci",a=document.createElement("div"),a.setAttribute("id",i),a.setAttribute("class","caviar-ui-controler-instance caviar-next"),a.innerHTML=n.template(e),t.contentBox.appendChild(a),new t.StagedView(n,a)}function a(n,e,a){var i,r,o=a||function(){};i=t.ControllersInstanceManager.get(n.controllerInstanceId).getViewElement(),r=t.ControllersInstanceManager.get(e.controllerInstanceId).getViewElement(),t.UITransitions.transitionIn(i,r,e.transition,o)}function i(n,e,a){var i,r,o=a||function(){};i=t.ControllersInstanceManager.get(n.controllerInstanceId).getViewElement(),r=t.ControllersInstanceManager.get(e.controllerInstanceId).getViewElement(),t.UITransitions.transitionOut(i,r,n.transition,o)}function r(n,e,a){var i,r;n&&(i=t.ControllersInstanceManager.get(n.controllerInstanceId).getViewElement().classList,i.remove("caviar-active"),i.add("caviar-backgrounded"),i.add("caviar-hidden")),r=t.ControllersInstanceManager.get(e.controllerInstanceId).getViewElement().classList,r.remove("caviar-next"),r.add("caviar-active"),t.isFunction(a)&&a()}var o=0;n.addViewToStage=e,n.transitionIn=a,n.transitionOut=i,n.transitionNone=r}(n=t.UIManager||(t.UIManager={}))}(Caviar||(Caviar={}));var Caviar;!function(t){var n,e;e=t.Config.get("version"),n=window.localStorage||{setItem:function(t,n){this[t]=n},getItem:function(t){return this[t]},removeItem:function(t){delete this[t]}};var a;!function(t){function a(t){var a=e+"_"+t;return n.getItem(a)}function i(t,a){var i=e+"_"+t;return n.setItem(i,a)}function r(t){var a=e+"_"+t;return n.removeItem(a)}function o(t){var a=e+"_"+t;return void 0!==n[a]}t.get=a,t.set=i,t.forget=r,t.has=o}(a=t.LayoutCache||(t.LayoutCache={}))}(Caviar||(Caviar={}));var Caviar;!function(t){var n;!function(n){function e(t){return t.replace("Controller","").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase()}function a(t,n){var a;return a=e(t),this.getViewObject(a,n)}function i(n){var a;return a=n.indexOf("Controller")>0?e(n):n,s[a]?void 0:this.getLayoutFile(a,function(n){var e=new t.View(n);s[a]=e})}function r(n,e){return s[n]?e(s[n]):void this.getLayoutFile(n,function(a){var i=new t.View(a);return s[n]=i,e(i)})}function o(n,e){var a,i,r=t.Config.get("debug");return i=t.runningOnWP()?"x-wmapp0:www/views/"+n+".html":"views/"+n+".html",!r&&t.LayoutCache.has(i)?e(t.LayoutCache.get(i)):(a=new XMLHttpRequest,a.onreadystatechange=function(){return 4===a.readyState?(t.Config.get("debug")||t.LayoutCache.set(i,a.responseText),e(a.responseText)):void 0},a.open("GET",i,!0),void a.send())}var s={};n.controllerNameToLayout=e,n.load=a,n.preload=i,n.getViewObject=r,n.getLayoutFile=o}(n=t.LayoutLoader||(t.LayoutLoader={}))}(Caviar||(Caviar={}));var Caviar;!function(t){var n=function(){function n(){this.eventListeners=[],this.name=null,this.view=null,this.data=null}return n.prototype.get=function(t){return this.data[t]},n.prototype.set=function(t,n){this.data[t]=n},n.prototype.beforeInitialize=function(t){},n.prototype.initialize=function(t){},n.prototype.onResume=function(t){},n.prototype.onLeave=function(){},n.prototype.onResult=function(t){},n.prototype.getViewElement=function(){return this.view.getElement()},n.prototype.listen=function(n,e,a){var i,r=this.getViewElement();i=function(n){t.matchSelector(n.target,e)&&a()},r.addEventListener(n,i,!1),this.eventListeners.push({event:n,callback:i})},n.prototype.destroyEventListeners=function(){var t,n,e=this.getViewElement(),a=this.eventListeners.length;for(t=0;a>t;t+=1)n=this.eventListeners[t],e.removeEventListener(n.event,n.callback,!1)},n.prototype.destroy=function(){this.data={}},n}();t.Controller=n}(Caviar||(Caviar={}));var Caviar;!function(t){var n;!function(n){function e(t){return void 0!==u[t]}function a(t){return u[t]||null}function i(n,e){var a,i,r=this,o=l(),a=n.controller;return i=App[a]?new App[a]:new t.Controller,i.name=a,i.data={},n.controllerInstanceId=o,i.beforeInitialize&&i.beforeInitialize(n),r.loadResources(i,function(a){return i.view=t.UIManager.addViewToStage(a,i.data),i.initialize(n),u[o]=i,e(o)})}function r(n,e){return t.LayoutLoader.load(n.name,e)}function o(t){var n=t.getViewElement();n.parentNode.removeChild(n)}function s(t,n){}function c(t){var n;n=this.get(t),n.destroyEventListeners(),n.destroy(),this.unloadResources(n),delete u[t]}var u,l,v;v=0,u={},l=function(){return v+=1,"uid"+v},n.exists=e,n.get=a,n.create=i,n.loadResources=r,n.unloadResources=o,n.restore=s,n.destroy=c}(n=t.ControllersInstanceManager||(t.ControllersInstanceManager={}))}(Caviar||(Caviar={}));var Caviar;!function(t){var n;!function(n){function e(){return p+=1}function a(t){m=t}function i(){return m}function r(){m=null}function o(t){C.push(t)}function s(t){I.push(t)}function c(){var e;e=$(document),h.Adapter.bind(window,"statechange",function(){var t,e,a;a=h.getState(),e=g,t=a.data.index||0,e>t&&n.back(),g=t}),document.addEventListener("backbutton",function(t){d(I)||t.preventDefault()},!1),e.on("tap",".caviar-back",function(t){h.back(),t.preventDefault()}),e.on("tap","[intent]",function(e){var a=this;t.Menu.isOpened()?(setTimeout(function(){n.start(new t.Intent(a),null)},200),t.Menu.hide()):n.start(new t.Intent(a),null),e.preventDefault()})}function u(e,a){var i,r=e;t.IntentHistory.add(r),t.ControllersInstanceManager.create(r,function(e){t.IntentHistory.hasPrev()?(i=t.IntentHistory.getPrev(),t.UIManager.transitionIn(i,r,function(){var e=n.getIndex();return h.pushState({index:e},null,"?state="+e),t.isFunction(a)&&a(),n.clearStack(r)})):t.UIManager.transitionNone(void 0,r,function(){t.isFunction(a)&&a()})})}function l(){var n,e,a,i;if(t.IntentHistory.hasPrev()){n=t.IntentHistory.getCurrent(),i=t.IntentHistory.getPrev(),e=t.ControllersInstanceManager.get(i.controllerInstanceId),a=t.ControllersInstanceManager.get(i.controllerInstanceId),e.onResume(a.onLeave()),null!==this.getResult()&&(e.onResult(this.getResult()),this.clearResult());var r=t.IntentHistory.removeLast();t.UIManager.transitionOut(n,i,function(){t.ControllersInstanceManager.destroy(r.controllerInstanceId)})}else t.exit()}function v(t){this.setResult(t),h.back()}function f(n){var e,a,i,r,o,s;if("MainController"===n.controller){for(i=t.IntentHistory.getCurrent(),e=t.IntentHistory.all(),a=e.length,o=a-1,r=0;o>r;r+=1)s=e[r],t.ControllersInstanceManager.destroy(s.controllerInstanceId);t.IntentHistory.clear(),t.IntentHistory.add(i)}}var d,p=0,g=0,h=History,m=null,C=[],I=[];d=function(t){var n,e,a=t.length,i=!1;for(n=0;a>n;n+=1)e=t[n],e()===!1&&(i=!0);return!i},n.getIndex=e,n.setResult=a,n.getResult=i,n.clearResult=r,n.beforeStartIntent=o,n.onBack=s,n.bindIntentElements=c,n.start=u,n.back=l,n.result=v,n.clearStack=f}(n=t.IntentManager||(t.IntentManager={}))}(Caviar||(Caviar={}));var Caviar;!function(t){var n;!function(n){function e(n){t.Config.set(n,void 0),"undefined"!=typeof cordova?document.addEventListener("deviceready",function(){i()},!1):i(),t.IntentManager.bindIntentElements()}function a(t){s.push(t)}var i,r,o,s=[];r=function(){return navigator},o=function(){var t,n,e=s.length;for(t=0;e>t;t+=1)(n=s[t])()},i=function(){var n=r();o(),t.IntentManager.start(new t.Intent("main"),function(){document.body.classList.add("resolved"),"undefined"!=typeof n.splashscreen&&n.splashscreen.hide()})},n.bootup=e,n.onApplicationStart=a}(n=t.Bootstrap||(t.Bootstrap={}))}(Caviar||(Caviar={}));var Caviar;!function(t){var n;!function(t){t.get=$.get,t.post=$.post}(n=t.HTTP||(t.HTTP={}))}(Caviar||(Caviar={}));var Caviar;!function(t){var n;!function(t){function n(t,n){Handlebars.registerHelper(t,n)}t.register=n}(n=t.Helpers||(t.Helpers={}))}(Caviar||(Caviar={}));var Caviar;!function(t){var n;!function(t){function n(t){var n=t||{element:document.querySelector(".snap-content"),disable:"right",transitionSpeed:.19};return s=new Snap(n),this.bindElements()}function e(){var t=this;c.on("tap",".caviar-open-menu-left",function(n){t.show("left"),n.preventDefault()}),c.on("tap",".caviar-open-menu-right",function(n){t.show("right"),n.preventDefault()}),c.on("tap",".caviar-toggle-menu-left",function(n){t.toggle("left"),n.preventDefault()}),c.on("tap",".caviar-toggle-menu-right",function(n){t.toggle("right"),n.preventDefault()}),c.on("tap",".caviar-menu-close",function(n){t.hide(),n.preventDefault()}),c.on("tap",".intent",function(n){t.hide(),n.preventDefault()}),document.addEventListener("backbutton",function(){t.hide()},!1)}function a(){return void 0!==s?s.close():void 0}function i(t){return void 0!==s?s.open(t):void 0}function r(t){void 0!==s&&("closed"===s.state().state?this.show(t):this.hide())}function o(){return void 0!==s?"closed"!==s.state().state:!1}var s,c=$(document);t.create=n,t.bindElements=e,t.hide=a,t.show=i,t.toggle=r,t.isOpened=o}(n=t.Menu||(t.Menu={}))}(Caviar||(Caviar={})),Caviar.Bootstrap.onApplicationStart(function(){return Caviar.Config.get("hasSidebarMenu")?Caviar.Menu.create({element:$(".snap-content")[0],disable:"right",transitionSpeed:.2}):void 0});